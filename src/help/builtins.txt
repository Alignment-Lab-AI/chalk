%{H Builtin functions in config files}%
The following functions are in addition to those documented at: {red}https://github.com/crashappsec/con4m{reset}
%{T <30:
Function::Description
osname() -> string{font0}::Returns the name of operating system.
arch() -> string::Returns information about the underlying architecture. Note that, when running under virtualization, this will return the virtualized platform.
version() -> string::Returns the release version of the chalk binary.
argv0() -> string::Returns the command being run, per the command line. If you've set up a default action in the embedded configuration, that configuration will receive {brown}default{black} for this value when it runs.  Possible options are: {brown}"insert", {brown}"extract", {brown}"delete", {brown}"defaults", {brown}"confdump", {brown}"confload", {brown}"version", {brown}"help"
argv() -> [string]::Returns the arguments being used for the command. This may not be what was passed at the command line; it will pick up default values from previous configuration files.  You may not change argv() with immediate effect, but for the {brown}"extract", {brown}"insert" and {brown}"delete" commands, setting the {bold}{magenta}artifact_path{black} variable will lead to argv updating after the script ends.
log(string, string)::The first argument may be, {brown}"error", {brown}"warn", {brown}"info"{black} or {brown}"verbose"{black}. The second argument is a message. This dispatches a message to the {magenta}log{black} topic.
sink_config(string, string, \{string: string\}, [string])::Set up a configuration for an output sink.  The first parameter is the name of the configuration, the second the name of the sink, the third, configuration parameters specific to that sink, and the fourth, any desired filters. Sinks may have multiple configurations. Sink configurations are immediately available from the configuration file, via {magenta}subscribe() {black}or {magenta}unsubscribe(){black}. See {red}{appName} help output{black} for more details.
subscribe(string, string)::Subscribes the sink configuration named in the first parameter, to the topic specified in the second parameter.  See {red}{appName} {red}help {red}output{black} for more information on topics.
unsubscribe(string, string)::Un subscribes the sink configuration named in the first parameter from the topic specified in the second parameter.  This allows you to override inherited subscriptions, such as the default logging subscription. See {red}{appName} {red}help {red}output{black} for more information on topics.
}%
